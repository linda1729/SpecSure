# 项目阶段说明（2025-11-29）

## 1）models 相关改动说明
- 本轮未改动 `backend/app/models` 下的 Pydantic schema 或 CNN 代码；现有模型接口保持不变。
- 新增的 CNN 对接逻辑在 `backend/app/services/cnn_gateway.py` 与 `model_service.py`，通过网关封装远端/本地占位推理，训练参数与返回结构对前端透明。

## 2）阶段报告
- 已完成：数据上传/预览、预处理（滤波/波段选择/标准化）、标注管理、SVM/RF 训练预测、CNN 占位/远端网关、评估指标（OA/Kappa/混淆矩阵）、像元查询、前端多视图与状态展示、API 文档（`backend/API.md` 与 `API_FULL.md`）。
- 计划（短期）：a) 按 `API_FULL.md` 补齐异步训练任务与历史流水线查询；b) 将 CNN 远端接口对接真实服务（配置 `CNN_API_BASE` 等环境变量）；c) 丰富数据导入格式与删除接口；d) 前端增加训练进度/日志展示。
- 当前问题/风险：本地未安装依赖导致 `fastapi` 导入失败；CNN 远端服务尚未接入（默认使用本地随机森林占位）；缺少自动化测试，需要手动验收主要流程。

## 3）运行与调试指引
- 依赖安装（需 Python3 环境）：`python3 -m venv .venv && source .venv/bin/activate && pip install -r requirements.txt`（若网络受限请使用本地镜像或离线包）。
- 启动后端：`uvicorn backend.app.main:app --reload --port 8000`；首次启动会自动生成 demo 数据集/标注，方便全链路演示。
- 配置 CNN 远端（可选）：设置 `CNN_API_BASE=http://your-cnn-host:port`，必要时配置 `CNN_API_PREDICT_PATH`、`CNN_API_KEY`、`CNN_API_TIMEOUT`。未配置时自动走本地占位推理。
- 启动前端（调试版）：`cd mockfrontend && python3 -m http.server 5500`；浏览器访问 `http://localhost:5500/`，如后端端口不同可在 URL 查询参数加 `?api=http://host:port`。
- 调试记录：尝试 `python3 -c "import backend.app.main"` 报 `ModuleNotFoundError: fastapi`，原因是依赖未安装；安装后应可正常导入。若使用 GPU CNN 服务未就绪，可直接用内置 demo 数据 + 占位推理完成训练/评估演示。
