# **实验 6：【Alpha】项目 Alpha 冲刺报告**

项目名：**SpecSure（澜瞳）**

小组名：**BlueArray（潮霸）**

周次：**第11周**

------

# **一、基本情况**

- **团队 ID：** 01
- **组长博客地址：** https://blog.linda1729.com/columns/specsure/
- **小组 Github 仓库地址：** https://github.com/linda1729/SpecSure
- **小组成员：**
  - 前端负责：於佳杰
  - 后端负责：刘芳宇（组长）
  - 模型训练（CNN）：陈怡冰
  - 模型训练（SVM）：邓林
- **本次冲刺范围**：根据附件的项目选题要求和功能结构，完成原型系统的 Alpha 版本雏形，包括需求确认、数据流程确定、模型初版、接口草案和页面原型等。
  - 选题参考：海岸带高光谱数据分类系统 ([Github链接](https://github.com/linda1729/SpecSure))
  - 分工参考：四模块（前端 / 后端 / SVM / CNN）并行推进 ([Github链接](https://github.com/linda1729/SpecSure))
  - 项目准备内容（数据、技术栈、工具）([Github链接](https://github.com/linda1729/SpecSure))
  - 系统预期功能及结构（最终目标）([Github链接](https://github.com/linda1729/SpecSure))

------

# **二、冲刺概况汇报**

------

## 前端：於佳杰

### ✅ **过去完成了哪些任务**

1. **完成前端整体需求确认与风格定调**
   - **风格确定**：经团队会议讨论，对比了“深色星空版”与“浅色简约版”两个Demo，最终决定采用**浅色（白色）简约风格**，以保证数据展示的清晰度。
   - **功能确认**：
     - **Data Import**：支持 `.hsi` / `.hdr` / `.mat` 上传，显示低分辨率 RGB 合成图。
     - **Preprocessing**：提供降噪、波段选择、标准化流程的可视化参数调节 UI。
     - **Model Training**：SVM 与 CNN 双模型切换，支持进度条、日志框及实时 Loss 曲线展示。
     - **Results**：分类结果伪彩色图、光谱对比曲线、混淆矩阵及准确率统计图。

2. **制作前端原型页面（静态版 Alpha）**
   - **技术栈**：React + TailwindCSS + ECharts。
   - **已完成页面**：
     - **Home 主页**：包含团队介绍、核心技术简介、项目展示模块，已应用确定的浅色 UI 风格。
     - **可视化 Demo**：制作了数据处理和可视化的静态演示效果，用于验证设计布局。
   - **待开发页面**：上传功能页、训练监控页（等待后端接口联调）。

3. **与后端协商 API 参数格式**
   - 确认了上传接口 `/upload_hsi` 的 multipart/form-data 格式。
   - 确认了分类接口 `/classify_cnn` 与 `/classify_svm` 的参数传递结构。
   - 确认了评估接口 `/evaluate` 的返回数据（混淆矩阵、Accuracy、Recall 等）。

### 📁 **Github 提交记录截图**

![commit截图-yjj](./images/commit%E6%88%AA%E5%9B%BE-yjj.png)

### 🔮 **接下来的计划**

- **UI 定稿与完善**：完善主页及静态页面的文案细节（填入真实的团队信息）。
- **接口联调**：待后端与模型端对接完成后，将静态的功能页面（上传、训练）接入真实 API。
- **动态交互**：实现上传文件的进度反馈和训练过程的动态图表更新。

### ⚠ **遇到的困难**

- 需求细节繁多，部分可视化交互（如波段选择滑块）实现复杂度较高，需要不断筛选优先级。

------

## 后端&组长工作：刘芳宇

### ✅ **过去完成了哪些任务**

1. **完成后端框架搭建**
   - 使用 **FastAPI** 建立了基础项目框架，设计了 RESTful API 架构。
   - 采用 Web 网页形式作为系统载体，已跑通基础的 Hello World 流程。
2. **开发 Mock 系统辅助测试**
   - **Mock 前端**：为了在前端未完成时测试后端逻辑，编写了一个简易的 Mock 前端（包含文件上传、加载示例数据、训练过程可视化占位）。
   - **Mock 数据**：在真实模型接入前，构造了伪造的训练日志和结果数据，验证了前后端通信链路。
3. **制定团队协作规范**
   - **Git 分支管理**：设立了 5 个分支，明确了“个人分支开发 -> Pull Request -> 合并至 Main 分支”的协作流程。
   - **文档规范**：建立了 `docs` 目录，要求成员每周更新个人日志和说明性文档。
4. **接口定义**
   - 初步约定了 API 接口文档，并与前端完成了格式对齐。

### 📁 **Github 提交记录截图**

> （请在此处插入后端 Github 提交记录截图）

### 🔮 **接下来的计划**

- **接入真实模型**：根据陈怡冰提供的文档，将 CNN/SVM 模型正式接入后端，替换目前的 Mock 数据。
- **完善接口文档**：根据模型端的输入输出需求，更新 API 文档并同步给前端。
- **环境部署**：尝试在云服务器或本地高性能机器上部署完整环境。

### ⚠ 遇到的困难 

- **模型对接**：目前后端与 AI 模型端的对接还在调试中，Mock 数据与真实数据的格式转换存在一定工作量。

------

## **CNN 模型：陈怡冰**

### ✅ 过去完成的任务

1. **所有基础功能的实现：**详情见`dos/w10/AlphaV4.md`
2. **代码重构与工程化**
   - 参考往届优秀仓库架构，将代码重构为 `API` (接口)、`Model` (模型)、`Train` (训练)、`Utils` (工具)、`Reports` (报告) 等模块。
   - 封装了推理 API，支持直接调用预训练权重进行预测。

### 📁 Github 提交记录截图

<img src="./images/commit%E6%88%AA%E5%9B%BE-cyb.png" style="zoom:75%;" />

### 🔮 接下来的计划

- [x] **撰写对接文档**：编写详细的 API 调用文档，明确 Input（前端传入参数）和 Output（返回 JSON 格式及图片路径），发给队长。

- [ ] **可视化：**提供训练loss曲线图

- [ ] **接口标准化**：根据后端反馈，调整接口的输入输出格式，确保能顺利接入 Web 系统。

- [x] **小规模测试**：准备一份小规模数据集，方便团队成员在非 GPU 环境下进行联调。

- [ ] **调研多模态方案**：探索是否可将光谱特征 + 空间纹理联合建模

### ⚠ 困难

- **计算资源**：本地训练速度较慢，需要优化数据加载策略。
- **接口对齐**：需要确保模型输出的 numpy 格式能被后端正确序列化为 JSON 发送给前端。

------

- **SVM 模型：邓林**

  ### ✅ 过去完成的任务

  1. **资料调研与环境搭建**

     * 学习了高光谱分类相关文献及学长学姐的参考代码。
     * 拉取了项目代码，熟悉了 Git 分支协作流程。

  2. **SVM 模型 Baseline**

     * 实现了 **SVM 的基本训练和预测功能**，支持 `linear`、`rbf` 核函数的选择。
     * 完成了 **OA (Overall Accuracy)** 和 **Kappa 系数** 的计算模块。
     * 通过使用 `scikit-learn` 中的 **SVMClassifier** 和 **SVMConfig**，完成了模型训练的代码封装。

  3. **数据处理**

     * 完成了 **数据准备**，包括将 `.mat` 格式的高光谱数据转换为 `X.npy` 和 `y.npy` 格式，以供 SVM 使用。
     * 开发了 **数据预处理功能**，包括降噪、波段选择和标准化。

  4. **可视化功能**

     * 实现了 **4 张图的生成**：包括 HSI 的 RGB 图、Ground Truth 图、SVM 预测图和预测错误图。
     * 可视化图像通过 `/static` 路径对外暴露，前端可以通过 URL 调用并显示。

  5. **API 接口开发**

     * 实现了 **FastAPI 后端接口**，允许前端调用 SVM 模型进行预测。
     * 接口返回了 **分类指标**（如 Accuracy 和 Kappa）以及 **图像 URL**（用于展示预测结果）。

  6. **前后端对接**

     * 配置了 **前端可调用的 API**（`POST /api/svm/run`），并通过前端展示分类指标和预测图像。

  ---

  ### 📁 Github 提交记录截图

  ![commit-截图-dl](images/commit-%E6%88%AA%E5%9B%BE-dl.png)

  ---

  ### 🔮 接下来的计划

  1. **前端对接与验证**
     * 确保前端可以通过接口成功调用后端 API，并在页面中正确显示分类结果与预测图像。

  2. **进一步优化与调优**

     * 对 **SVM 模型的超参数**（如 `C`、`gamma`）进行优化，提升分类精度。
     * 对 **分类结果进行多轮对比实验**，生成不同数据集上的性能报告。

  3. **性能评估**

     * 对 **SVM 模型的不同配置**（核函数、惩罚系数等）进行性能对比，记录并分析其在不同数据集上的表现。

  ---

  ### ⚠ 遇到的困难

  * **数据集标准化问题**：由于每个数据集的光谱维度和标签格式可能不同，标准化数据预处理和特征提取时需要确保各个数据集的一致性。
  * **模型训练时内存消耗问题**：在较大的数据集（如 Salinas）上训练时，内存和计算资源有时会出现瓶颈，需要进一步优化训练过程或引入更多的数据分批处理方式。
  * **模型调优需要多次实验**：需要对模型的不同参数（如 `C`、`gamma`）进行网格搜索，并手动调优，以便找到最合适的配置。

  ---

  ### 结语：

  本周的工作主要集中在 **SVM 模型的实现、API 接口开发、前后端对接、支持用户上传数据** 以及 **可视化功能的集成**。目前模型已经能够对指定的数据集进行训练，并返回准确率和分类报告。接下来将专注于与前端对接，确保用户能够在前端界面上上传数据并查看预测结果，同时对模型进行进一步的优化。

------

# **三、冲刺成果展示**

## **1. 组内最新成果展示**

以下成果基于目前 Alpha 阶段进展：

### **① 系统整体 UI 原型（前端：於佳杰）**

- **风格确认**：最终选定浅色（白色）简约风格。

- **主页实现**：完成了包含团队介绍、技术栈展示、数据处理流程演示的静态主页。

- **页面结构**：确立了“数据导入 -> 预处理 -> 模型训练 -> 结果评估”的四步工作流 UI 框架。

  `白色前端`如下：

> ![image-20251206203402341](./images/image-20251206203402341.png)

------

### **② 后端架构与 Mock 系统（后端：刘芳宇）**

- **框架**：FastAPI 后端服务已启动。
- **测试桩**：实现了 Mock 前端与 Mock 数据接口，确保在模型未接入前可演示完整流程。
- **API**：已定义 `/upload`, `/train`, `/predict` 等核心接口规范。

------

### **③ CNN模型重构与可视化（算法：陈怡冰）**

- **工程化目录**：完成了清晰的目录结构划分。
- **可视化输出**：实现了混淆矩阵热力图、分类报告文本生成。
- **推理接口**：封装了可直接调用的 Python Class 接口。

`混淆矩阵`如下：

<img src="./images/Salinas_confusion_infer_pca=15_window=25.png" style="zoom:33%;" />

`groundtruth可视化`如下（验证以及推理时都有该图片）：

<img src="./images/Salinas_groundtruth.png" style="zoom: 67%;" />

`report`内容如下：

```txt
Test loss (%) 0.0521
Test accuracy (%) 99.9938

Kappa accuracy (%) 99.99
Overall accuracy (%) 99.99
Average accuracy (%) 100.00

              precision    recall  f1-score   support

           0       1.00      1.00      1.00       603
           1       1.00      1.00      1.00      1118
           2       1.00      1.00      1.00       593
           3       1.00      1.00      1.00       418
           4       1.00      1.00      1.00       803
           5       1.00      1.00      1.00      1188
           6       1.00      1.00      1.00      1074
           7       1.00      1.00      1.00      3381
           8       1.00      1.00      1.00      1861
           9       1.00      1.00      1.00       983
          10       1.00      1.00      1.00       320
          11       1.00      1.00      1.00       578
          12       1.00      1.00      1.00       275
          13       1.00      1.00      1.00       321
          14       1.00      1.00      1.00      2181
          15       1.00      1.00      1.00       542

    accuracy                           1.00     16239
   macro avg       1.00      1.00      1.00     16239
weighted avg       1.00      1.00      1.00     16239

//这里会显示混淆矩阵的数据，上述图片已经展示相关数据，不再占位展示原始数据
```



------

### **④ SVM模型重构与可视化（算法：邓林）**

- **工程化目录**：完成了清晰的目录结构划分。
- **可视化输出**：实现了混淆矩阵热力图、分类报告文本生成。
- **推理接口**：封装了可直接调用的 Python Class 接口。

模型对输入的模型可输出四种结果可视化图：

依次为：

- Ground Truth（地面真实标签图）

  这张图展示的是 **地面真实标签（GT）**，即每个像元的真实分类标签。每个区域的颜色代表不同的分类。颜色条（右侧）显示了不同类别的数值（从 0 到 16）。

  图示中，每个颜色对应一个类别，如红色代表类别 `16`，绿色代表类别 `2` 等

- HSI 图像（高光谱影像 RGB 图）

  这张图是 **高光谱影像的 RGB 可视化图**，将多个波段组合成红、绿、蓝三个波段，生成类似于普通 RGB 图像的可视化效果。这张图反映了数据中的颜色分布，用于展示高光谱数据的视觉效果。

- Correct (绿色) vs Error (红色) 图

  这张图显示了 **分类结果的正确性**，绿色代表正确分类的像元，红色代表错误分类的像元。

  绿色区域是 **预测正确** 的地方，红色区域是 **预测错误** 的地方。

- SVM Predictions（SVM 预测结果图）

  这张图展示的是 **SVM 模型的预测结果**，颜色表示模型对每个像元的分类。不同颜色的区域表示不同的分类结果。

  该图展示了 SVM 模型对整个影像的分类预测。

<img src="images/gt_labels.png" alt="gt_labels" style="zoom:33%;" />

<img src="images/hsi_rgb.png" alt="hsi_rgb" style="zoom:33%;" />

<img src="images/svm_errors.png" alt="svm_errors" style="zoom:33%;" />

<img src="images/svm_pred_labels.png" alt="svm_pred_labels" style="zoom:33%;" />

### **⑤ 项目管理完成度**

已完成：

- **协作规范**：确立了 5 分支管理策略（Main + 4 个人分支）。
- **文档管理**：建立了 `docs` 文件夹，按人名归档周报与技术文档。

------

## **2. 站立会议合照**

<img src="./images/%E4%BC%9A%E8%AE%AE%E7%85%A7%E7%89%87.jpg" style="zoom: 25%;" />

------

## **3. 会议时间、地点、内容记录**

- **时间：** 12 月 3 日
- **地点：** 线上/线下会议室
- **记录内容：**
  - **整体框架**：确认使用 FastAPI + Web 形式，后端已搭建 Mock 前端用于测试。
  - **UI 风格**：全员投票确认主要采用**浅色（白色）**风格，设置夜间\日间变化，由於佳杰负责主页及静态页美化。
  - **接口对接**：队长要求算法组（陈怡冰）提供详细的 Input/Output 文档，优先将 CNN 模型接入后端框架。
  - **开发策略**：确定“简化原则”，初期使用小规模数据集进行开发调试，避免硬件瓶颈。
  - **协作规范**：再次强调 Git 操作流程（先拉取 Main -> 个人分支开发 -> 申请合并），文档统一存放在 `docs` 目录。